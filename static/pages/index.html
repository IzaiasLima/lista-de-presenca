<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/style.css">
    <title>Tabela de Presença</title>
</head>

<body>
    <div class="container">
        <div class="card">
            <div class="header">
                <h1>Frequência Semanal do NCC</h1>
                <img class="login" src="../images/exit.png" onclick="event.preventDefault(); logout();" alt="exit">
            </div>

            <div class="input-group">
                <input type="text" id="new-person" placeholder="Nome do participante">
                <input type="text" id="new-person-phone" placeholder="Telefone">
                <button class="btn primary" onclick="addPerson()">
                    <span>
                        <img class="login" src="/images/plus.png">
                    </span>
                    <span class="btn-label">
                        Adicionar
                    </span>
                </button>
            </div>

            <div class="navigation">
                <div class="weeks">
                    <div>
                        <label>Semana:</label>
                        <input type="number" id="current-week" min="1" max="52" onchange="rebuild()">
                        <div class="btns-weeks">
                            <button class="btn primary" onclick="rebuild()">Seleciona Semana</button>
                            <button class="btn primary" onclick="setCurrentWeek()">Semana Atual</button>
                        </div>
                    </div>
                </div>
            </div>


            <dialog id="person-details" class="dialog">
                <article class="article">
                    <header>
                        <span onclick="closePersonDialog()">×</span>
                    </header>

                    <div class="dlg-body">
                        <!-- dados do participante -->
                        <p>Nome: <span id="dlg-name">Izaias Lima</span></p>
                        <a id="dlg-phone-link" href="" target="_blank" rel="nofollow noopener noreferrer">
                            <span id="dlg-phone">9999-9999</span>
                        </a>
                    </div>
                </article>
            </dialog>

            <div id="loading">
                <img src="../icons/spinner.svg" alt="loadding">
            </div>
            <div id="has-no-data">
                Não há dados na semana selecionada nem nas semanas adjacentes.
            </div>
            <table id="presence-table" style="display: none;"></table>

            <div id="toast">
                <span id="message">
                    <!-- Mensagem de notificação -->
                </span>
            </div>


            <div id="empty-state" style="display: none;">
                Adicione participantes para começar o controle de frequência
            </div>
        </div>

        <div class="instructions">
            <h2>Instruções:</h2>
            <ul>
                <li>• Adicione participantes usando o campo acima</li>
                <li>• Clique nas células para marcar presença (verde) ou ausência (cinza)</li>
                <li>• Use "Selecionar semana" para navegar pelas 52 semanas</li>
                <li>• Apenas a semana atual (destacada com ★) pode ser editada</li>
                <li>• A linha "Total" mostra a soma de participantes presentes em cada semana</li>
            </ul>
        </div>
    </div>

    <script src="../js/auth.js"></script>
    <script>
        // Verifica autenticação antes de executar o script principal
        if (window.auth) {
            window.auth.requireLogin();
        }
    </script>
    <script src="../js/main.js"></script>
    <script src="../js/login.js"></script>
    <script src="../js/table.js"></script>


</body>

</html>